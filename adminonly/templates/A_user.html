{% extends 'adminHeader.html' %}
{% load crispy_forms_tags %}
{% block title %}User Management | AniWatch Studio {% endblock %}
{% block A_user %}<a class="active" href="/studio/user">User</a> {% endblock %}
{% block userbutton %}
    <button class="btn btn-outline-warning dropdown-toggle" type="button" id="dropdownMenuButton"
            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Admin
    </button>
{% endblock %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">

<style>
    body {
	  background-color: #2b2b31;
	  font-family: 'Ubuntu', sans-serif;
	}
    .overlay-content label, clearablefileinput{
        color:white;
    }
    .overlay {
      height: 100%;
      width: 0;
      position: fixed;
      z-index: 1031;
      top: 0;
      left: 0;
      background-color: rgb(0,0,0);
      background-color: rgba(0,0,0, 0.9);
      overflow-x: hidden;
      transition: 0.5s;
      overscroll-behavior: contain;
    }
    .errorlist li{
        color:red;
    }
    form p{
        color:gold;
    }

    
    .form-control{
        width:25vw;
    }
    .help-block{
        display:none;
    }
    .checkboxinput{
        height: 2vw;
        width:2vw;
    }
    .overlay-content {
      position: relative;
      top: 10%;
      width: 100%;
      margin-top: 30px;
      margin-left: 30vw;
    }
    .overlay-content{
        width: 35%;
        padding-left:5vw;
        padding-bottom:5vw;
        padding-top:2vw;
        border-radius:25px;
        background-color:#696969;
    }
    
    .overlay a {
      padding: 8px;
      text-decoration: none;
      font-size: 36px;
      color: #818181;
      display: block;
      transition: 0.3s;
    }
    
    .overlay a:hover, .overlay a:focus {
      color: #f1f1f1;
    }
    
    .overlay .closebtn {
      position: absolute;
      top: 20px;
      right: 45px;
      font-size: 60px;
    }
    
    @media screen and (max-height: 450px) {
      .overlay a {font-size: 20px}
      .overlay .closebtn {
      font-size: 40px;
      top: 15px;
      right: 35px;
      }
    }
    table th,table td{font-size: 1.2vw;}
</style>
<div class="clear"></div>

<h1 style="color:white;font-size:2vw; float:left;">All Users</h1>
<div id="myNav" class="overlay">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <div class="overlay-content">
        <div class="container">
            <h1 style="color:orange; font-size:2vw;">Add User</h1>
            <form enctype="multipart/form-data" method="post">
                {% csrf_token %}
                {{ userform|crispy }}
                <button type="submit" name="adduser" class="btn btn-outline-warning">Save</button>
            </form>
            </div>
    </div>
</div>
<button class="btn btn-outline-warning" onclick="openNav()" style="float:right; font-size: 1.2vw;"><i
        class="bi bi-people"></i> Add
    User</button>
<div class="clear"></div>
{% for message in messages %}
    <h4 style="color:red;">{{message}}</h4>
{% endfor %}

<table class="table table-striped table-light">
    <thead>
        <tr>
            <th scope="col">id</th>
            <th scope="col">Username</th>
            <th scope="col">First Name</th>
            <th scope="col">Last Name</th>
            <th scope="col">Email</th>
            <th scope="col">Is_active</th>
            <th scope="col">Date Joined</th>
            <th scope="col">Function</th>
        </tr>
    </thead>
    <tbody>
        {% for user in user %}
        <tr>
            <td scope="row">{{user.id}}</td>
            <td>{{user.username}}</td>
            <td>{{user.first_name}}</td>
            <td>{{user.last_name}}</td>
            <td>{{user.email}}</td>
            <td>{{user.is_active}}</td>
            <td>{{user.date_joined}}</td>
            <td>
                <form method="POST" action="{% url 'adminonly:delete_user' user.pk %}">
                    {% csrf_token %}
                    <button type="submit" name="delete" title="delete user"
                        class="btn btn-sm" style="color:#DC143C"><i class="far fa-trash-alt fa-2x"
                                                          onclick="return confirm('Are you sure you want to Delete the user?')"></i></button>
                    <button type="submit" name="block" title="Block user"
                        class="btn btn-sm" style="color:#DC143C"><i class="fas fa-ban fa-2x"
                                                          onclick="return confirm('Are you sure you want to Block/Unblock the user?')"></i></button>
                </form>
		    </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<script>
    function openNav() {
      document.getElementById("myNav").style.width = "100%";
      document.documentElement.style.overflow = 'hidden';
      document.body.scroll = "no";
    }
    
    function closeNav() {
      document.getElementById("myNav").style.width = "0%";
      document.documentElement.style.overflow = 'visible';
      document.body.scroll = "yes";
    }
</script>
{% endblock %}